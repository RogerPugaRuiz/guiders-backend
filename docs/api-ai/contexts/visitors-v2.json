{
  "context": "visitors-v2",
  "description": "Gestión de visitantes V2 optimizada",
  "controllers": [
    {
      "name": "SitesController",
      "context": "visitors-v2",
      "baseUrl": "sites",
      "description": "Controller sin descripción",
      "tags": [
        "sites"
      ],
      "endpoints": [
        {
          "method": "POST",
          "path": "/sites/resolve",
          "summary": "Resolver sitio por host",
          "description": "Resuelve el host actual del navegador (ejemplo: landing.mytech.com) y determina a qué site y tenant pertenece. El host es solo un alias que se mapea al modelo interno (siteId, tenantId) para trabajar con identidades estables.",
          "tags": [],
          "auth": {
            "required": false,
            "bearer": false
          },
          "parameters": {
            "query": [
              {
                "name": "host",
                "description": "Host del navegador a resolver",
                "example": "landing.mytech.com",
                "required": false,
                "type": "string"
              }
            ]
          },
          "responses": [],
          "examples": {}
        }
      ],
      "filePath": "src/context/visitors-v2/infrastructure/controllers/sites.controller.ts"
    },
    {
      "name": "VisitorV2Controller",
      "context": "visitors-v2",
      "baseUrl": "visitors",
      "description": "Controller sin descripción",
      "tags": [
        "visitors"
      ],
      "endpoints": [
        {
          "method": "POST",
          "path": "/visitors/identify",
          "summary": "Identificar visitante",
          "description": "Registra o actualiza un visitante en el sistema usando dominio y API Key.",
          "tags": [],
          "auth": {
            "required": false,
            "bearer": false
          },
          "parameters": {
            "body": {
              "description": "Datos del visitante para identificación",
              "type": "object",
              "required": true
            }
          },
          "responses": [],
          "examples": {}
        },
        {
          "method": "POST",
          "path": "/visitors/session/heartbeat",
          "summary": "Actualizar heartbeat de sesión",
          "description": "Mantiene viva la sesión abierta. Actualiza el timestamp de última actividad (lastActivityAt). Mientras se reciban heartbeats, el visitante se considera online.",
          "tags": [],
          "auth": {
            "required": false,
            "bearer": false
          },
          "parameters": {},
          "responses": [],
          "examples": {}
        },
        {
          "method": "POST",
          "path": "/visitors/session/end",
          "summary": "Cerrar sesión de visitante",
          "description": "Cierra explícitamente una sesión de visitante. Marca la sesión como terminada (ya no se cuenta como activa). Dispara eventos de negocio para sacar al visitante de la lista de",
          "tags": [],
          "auth": {
            "required": false,
            "bearer": false
          },
          "parameters": {},
          "responses": [],
          "examples": {}
        }
      ],
      "filePath": "src/context/visitors-v2/infrastructure/controllers/visitor-v2.controller.ts"
    }
  ],
  "summary": {
    "controllersCount": 2,
    "endpointsCount": 4
  }
}